<!DOCTYPE html>
<!-- saved from url=(0037)http://shtech.org/course/ca/19s/hw/3/ -->
<html class="gr__shtech_org"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Homework 3 - Computer Architecture I - ShanghaiTech University</title>
<link rel="shortcut icon" type="image/png" href="http://shtech.org/course/ca/19s/favicon.ico">

<style type="text/css">
code {background-color: #ddeeff; color: #000000;}
kbd {background-color: #ddeeff; color: #000000;}
.new {background-color: #ffff00; color: #000000;}
</style>
</head>
<body data-gr-c-s-loaded="true">
<header>
<h2>Homework 3</h2>
</header>

<a href="http://shtech.org/course/ca/19s/">Computer Architecture I</a> <a href="http://www.shanghaitech.edu.cn/">ShanghaiTech University</a>
<br>
<a href="http://shtech.org/course/ca/19s/hw/2">HW2</a> HW3 <!--a href="../4">HW4</a-->


<h3 id="task-1-ship-lists-in-c">Quick Sort</h3>
<h4 id="instructions">Instructions</h4>

<p> In this task you will be writing a <a href="https://en.wikipedia.org/wiki/Quick_sort">quick sort</a> using RISC-V. We have written some code for you, but you have to finish the most important part all by yourself. You can download the src <a href="http://shtech.org/course/ca/19s/hw/3/hw3_frame.asm">here</a>. </p>
    <p> Quick sort can be "partitioned" into two parts: </p>
    <ul>
      <li> Partition. Each time you get hand on an array, try to partition them based on a pivot at your disposal.
<pre><code>
<b>algorithm</b> partition(A, lo, hi) <b>is</b>
    pivot := A[hi]
    i := lo - 1    
    <b>for</b> j := lo <b>to</b> hi - 1 <b>do</b>
        <b>if</b> A[j] &lt; pivot <b>then</b>
            i := i + 1
            swap A[i] with A[j]
    swap A[i + 1] with A[hi]
    <b>return</b> i + 1 </code></pre>
      </li>
      <li> Quick sort. With an array partitioned into two parts, apply quick sort on each one of them. 
<pre><code>
<b>algorithm</b> quicksort(A, lo, hi) <b>is</b>
    <b>if</b> lo &lt; hi <b>then</b>
        p := partition(A, lo, hi)
        quicksort(A, lo, p - 1 )
        quicksort(A, p + 1, hi) </code></pre>
      </li>
    </ul>
    <p> Source for the code above:  <a href="https://en.wikipedia.org/wiki/Quick_sort">Wikipedia</a></p>
    <p> If you are not familiar with these two process, <a href="https://en.wikipedia.org/wiki/Quicksort#Algorithm">here</a> are some help.</p>
    <p> The code we wrote follows these two procedures too. Mind that you must fill two functions and you MUST NOT combine them or we WILL NOT grade your homework. We enforce this for a reason. One, it's good to get things separated and keep your mind cool; besides, you also need to practice save(and load) from(to) memory before calling a function.</p>

<h4 id="consider-learning-before-you-start">Consider Learning Before You Start</h4>
  <ul>
  <li>Recursive functions</li>
  <li>Save and Load from Memory using RISC-V</li>
  <li>Patience!</li>
  <li>Usually it is quite helpful to write the according C code first and then translate it into RISC-V.</li>
  <li>Use the comments to note what the line is actually doing in C.</li>
  </ul>
<h4>What you should do</h4>
	<ul>
		<li><p>You should take your algorithm on a array which contains <b>10</b> integers. The array has been allocated space on static partition in line <b>40</b>. You can change that array to whatever you like but <b>DO NOT</b> change the line number of it and anything else around them.</p></li>
		<li><p>Function <code>def_quick_sort</code> is the quick sort function, you can write your implementation here. And in this function, you should use another function <code>def_partition</code>.</p></li>
		<li>In function <code>def_partition</code>, you should separate a list into two partition. You can choose whatever method you like for detailed implementation.</li>
		<li><p>After label <code>exit</code>, you should set correct parameter to the environment call, which allows exit the program with exit code <code>0</code>. For more <code>ecall</code> information, see <a href="https://github.com/ThaumicMekanism/venus/wiki">here</a>.</p></li>
		<li><p>Finally, finish the auxiliary function <code>print</code>. You should print an array form the begin (its address in <code>a1</code>) to the end. Two numbers will be separated by space. e.g.: </p><div class="checkoff">
			<ul>
				<li>List need sort: 678 567 456 765 876 987 543 654 684 374 </li>
				<li>Sorted:         374 456 543 567 654 678 684 765 876 987 </li>
			</ul>
			</div><p></p></li>
		<li>You should not change anything others.</li>
	</ul>

<h4 id="heads-ups"> Heads Ups </h4>
<ul>
  <li id="register-rule"> <b>Register Rule #1.</b> You are offered with limited registers: <b>zero</b>,<b>ra</b>, <b>sp</b>, <b>a0 - a1</b>, <b>a2 - a4</b>, <b>t3 - t6</b>, <b>s2 - s5</b>. We banned some t registers to keep your minds sharp or you might get drowned in a sea of registers.</li>
  <li> <b>Register Rule #2.</b> Do understand and employ the registers' convention which is another way to keep you from feeling dizzy. If you are not sure about them, here we listed them below:
    <ul>
      <li> Use <b>zero</b> instead of <b>x0</b>; </li>
      <li> use <b>a0</b> for system call; </li>
      <li> use <b>s2 - s5</b> as saved value; </li> 
      <li> use <b>a0 - a4</b> as function parameters; </li>
      <li> use <b>t3 - t6</b> as temporary registers; </li>
      <li> you can't mess up with <b>ra</b>, <b>sp</b>, etc. anyway :) </li>
    </ul> 
  </li>
  <li id="comment-rule"> <b>Comment Rule.</b> You need to have <b> MEANINGFUL </b> comments not less than <b>50%</b> of the total lines of code you wrote. A comment is defined by a sentence followed by a comment symbol(aka. #)</li>
  <li> <b>IMPORTANT!</b> Failure to comply to the <a href="http://shtech.org/course/ca/19s/hw/3/#register-rule">Register Rules(rule #1 and #2)</a> will cost you at least 30% of scores of this homework. 50% of this homework's total scores will also be deducted if you can't write enough meaningful comments according to <a href="http://shtech.org/course/ca/19s/hw/3/#comment-rule">comment rule</a>.  </li>

</ul>
<h3 id="submission">Submission</h3>
You should <b>NOT</b> change the structure of the code above line <b>70</b>. And also, we will check registers validation. Besides, your code should no longer than <b>450</b> lines. Additional, make sure your code has at least <b>50%</b> commits. Save your code into a file, then submit the file in autolab, the name of the file doesn't matter, but recommended <code>hw3.asm</code>.
<hr>
Last Modified: Mar. 15th, 2019 by Wang Ruoyu(wangry@shanghaitech.edu.cn)


</body></html>